{"remainingRequest":"/Users/yokoyamakenta/Desktop/choco_mart/node_modules/babel-loader/lib/index.js!/Users/yokoyamakenta/Desktop/choco_mart/node_modules/eslint-loader/index.js??ref--13-0!/Users/yokoyamakenta/Desktop/choco_mart/src/plugins/firebase.js","dependencies":[{"path":"/Users/yokoyamakenta/Desktop/choco_mart/src/plugins/firebase.js","mtime":1602918956897},{"path":"/Users/yokoyamakenta/Desktop/choco_mart/node_modules/cache-loader/dist/cjs.js","mtime":1599521191920},{"path":"/Users/yokoyamakenta/Desktop/choco_mart/node_modules/babel-loader/lib/index.js","mtime":1599521191611},{"path":"/Users/yokoyamakenta/Desktop/choco_mart/node_modules/eslint-loader/index.js","mtime":1599521192603}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJyZWdlbmVyYXRvci1ydW50aW1lL3J1bnRpbWUiOwppbXBvcnQgX2FzeW5jVG9HZW5lcmF0b3IgZnJvbSAiL1VzZXJzL3lva295YW1ha2VudGEvRGVza3RvcC9jaG9jb19tYXJ0L25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9hc3luY1RvR2VuZXJhdG9yIjsKaW1wb3J0IFZ1ZSBmcm9tICd2dWUnOwppbXBvcnQgZmlyZWJhc2UgZnJvbSAnZmlyZWJhc2UnOwppbXBvcnQgc3RvcmUgZnJvbSAiQC9zdG9yZSI7CnZhciBjb25maWcgPSB7CiAgYXBpS2V5OiAiQUl6YVN5RDh0NVFKRU1LYmc1UllvUE40OHprN0tqdGg2SGIwZnhNIiwKICBhdXRoRG9tYWluOiAiY2hvY28tbWFydC5maXJlYmFzZWFwcC5jb20iLAogIGRhdGFiYXNlVVJMOiAiaHR0cHM6Ly9jaG9jby1tYXJ0LmZpcmViYXNlaW8uY29tIiwKICBwcm9qZWN0SWQ6ICJjaG9jby1tYXJ0IiwKICBzdG9yYWdlQnVja2V0OiAiY2hvY28tbWFydC5hcHBzcG90LmNvbSIsCiAgbWVzc2FnaW5nU2VuZGVySWQ6ICI3NzkwNDcwMjk1MjQiLAogIGFwcElkOiAiMTo3NzkwNDcwMjk1MjQ6d2ViOmMzN2Q3MzgwNDQyODRmNzI3YjUwMDEiLAogIG1lYXN1cmVtZW50SWQ6ICJHLTJQREJNWUJXNVoiCn07CnZhciBWQVBJRF9LRVkgPSAnQkNEdzN2N3B6d3AzeWJNc2NIUW9BTWVaMHFFVlBOeFI2bEJYdDRfSWVVT3RoT0R6ZnBYVnNtaE53UGd4S01VeDlCMExmWDZrNUVFX0hFYUNWbmdGR1c0JzsKZXhwb3J0IGRlZmF1bHQgewogIGluaXQ6IGZ1bmN0aW9uIGluaXQoKSB7CiAgICBmaXJlYmFzZS5pbml0aWFsaXplQXBwKGNvbmZpZyk7CiAgICBmaXJlYmFzZS5hbmFseXRpY3MoKTsKICAgIGZpcmViYXNlLmF1dGgoKS5zZXRQZXJzaXN0ZW5jZShmaXJlYmFzZS5hdXRoLkF1dGguUGVyc2lzdGVuY2UuTE9DQUwpOwogIH0sCiAgc2lnbkluQW5vbnltb3VzbHk6IGZ1bmN0aW9uIHNpZ25JbkFub255bW91c2x5KCkgewogICAgcmV0dXJuIGZpcmViYXNlLmF1dGgoKS5zaWduSW5Bbm9ueW1vdXNseSgpOwogIH0sCiAgbG9nb3V0OiBmdW5jdGlvbiBsb2dvdXQoKSB7CiAgICBmaXJlYmFzZS5hdXRoKCkuc2lnbk91dCgpOwogIH0sCiAgZ2V0VmFwaWRLZXk6IGZ1bmN0aW9uIGdldFZhcGlkS2V5KCkgewogICAgcmV0dXJuIFZBUElEX0tFWTsKICB9LAogIG9uQXV0aDogZnVuY3Rpb24gKCkgewogICAgdmFyIF9vbkF1dGggPSBfYXN5bmNUb0dlbmVyYXRvcigKICAgIC8qI19fUFVSRV9fKi8KICAgIHJlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUoKSB7CiAgICAgIHZhciB1c2VyRGF0YSwgdXNlclJlZiwgc2VsbFJlZiwgYnV5UmVmLCBub3RpY2VSZWY7CiAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlJChfY29udGV4dCkgewogICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0LnByZXYgPSBfY29udGV4dC5uZXh0KSB7CiAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMjsKICAgICAgICAgICAgICByZXR1cm4gdGhpcy5zaWduSW5Bbm9ueW1vdXNseSgpOwoKICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAgIHVzZXJEYXRhID0gX2NvbnRleHQuc2VudDsKICAgICAgICAgICAgICBzdG9yZS5jb21taXQoJ2F1dGgvb25BdXRoU3RhdGVDaGFuZ2VkJywgdXNlckRhdGEudXNlcik7CiAgICAgICAgICAgICAgc3RvcmUuY29tbWl0KCdhdXRoL29uVXNlclN0YXR1c0NoYW5nZWQnLCB1c2VyRGF0YS51c2VyLnVpZCA/IHRydWUgOiBmYWxzZSk7CiAgICAgICAgICAgICAgdXNlclJlZiA9IGZpcmViYXNlLmZpcmVzdG9yZSgpLmNvbGxlY3Rpb24oInVzZXJzIikuZG9jKHVzZXJEYXRhLnVzZXIudWlkKTsKICAgICAgICAgICAgICBzZWxsUmVmID0gZmlyZWJhc2UuZmlyZXN0b3JlKCkuY29sbGVjdGlvbigic2VsbHMiKS5kb2ModXNlckRhdGEudXNlci51aWQpOwogICAgICAgICAgICAgIGJ1eVJlZiA9IGZpcmViYXNlLmZpcmVzdG9yZSgpLmNvbGxlY3Rpb24oImJ1eXMiKS5kb2ModXNlckRhdGEudXNlci51aWQpOwogICAgICAgICAgICAgIG5vdGljZVJlZiA9IGZpcmViYXNlLmZpcmVzdG9yZSgpLmNvbGxlY3Rpb24oIm5vdGljZXMiKS5kb2ModXNlckRhdGEudXNlci51aWQpOwogICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAxMTsKICAgICAgICAgICAgICByZXR1cm4gdXNlclJlZi5nZXQoKS50aGVuKGZ1bmN0aW9uIChkb2MpIHsKICAgICAgICAgICAgICAgIGlmIChkb2MuZXhpc3RzKSB7CiAgICAgICAgICAgICAgICAgIHVzZXJSZWYudXBkYXRlKHsKICAgICAgICAgICAgICAgICAgICB1cGRhdGVkX2F0OiBmaXJlYmFzZS5maXJlc3RvcmUuRmllbGRWYWx1ZS5zZXJ2ZXJUaW1lc3RhbXAoKQogICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgIC8vIOWIneacn+ioreWumijjg6bjg7zjgrbjg7wpCiAgICAgICAgICAgICAgICAgIHVzZXJSZWYuc2V0KHsKICAgICAgICAgICAgICAgICAgICB1cGRhdGVkX2F0OiBmaXJlYmFzZS5maXJlc3RvcmUuRmllbGRWYWx1ZS5zZXJ2ZXJUaW1lc3RhbXAoKSwKICAgICAgICAgICAgICAgICAgICBjcmVhdGVkX2F0OiBmaXJlYmFzZS5maXJlc3RvcmUuRmllbGRWYWx1ZS5zZXJ2ZXJUaW1lc3RhbXAoKSwKICAgICAgICAgICAgICAgICAgICBuYW1lOiAi5ZCN44KC54Sh44GN5YaS6Zm66ICFIgogICAgICAgICAgICAgICAgICB9KTsgLy8g5Yid5pyf6Kit5a6aKOWjsuOCiykKCiAgICAgICAgICAgICAgICAgIHNlbGxSZWYuc2V0KHsKICAgICAgICAgICAgICAgICAgICBjb3VudDogMTUKICAgICAgICAgICAgICAgICAgfSk7IC8vIOWIneacn+ioreWumijlo7LjgospCgogICAgICAgICAgICAgICAgICBidXlSZWYuc2V0KHsKICAgICAgICAgICAgICAgICAgICBjb3VudDogMTUKICAgICAgICAgICAgICAgICAgfSk7IC8vIOWIneacn+ioreWumijpgJrnn6UpCgogICAgICAgICAgICAgICAgICBub3RpY2VSZWYuc2V0KHsKICAgICAgICAgICAgICAgICAgICBpdGVtczogW10KICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICBjYXNlIDExOgogICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5zdG9wKCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9LCBfY2FsbGVlLCB0aGlzKTsKICAgIH0pKTsKCiAgICBmdW5jdGlvbiBvbkF1dGgoKSB7CiAgICAgIHJldHVybiBfb25BdXRoLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICB9CgogICAgcmV0dXJuIG9uQXV0aDsKICB9KCkKfTs="},{"version":3,"sources":["/Users/yokoyamakenta/Desktop/choco_mart/src/plugins/firebase.js"],"names":["Vue","firebase","store","config","apiKey","authDomain","databaseURL","projectId","storageBucket","messagingSenderId","appId","measurementId","VAPID_KEY","init","initializeApp","analytics","auth","setPersistence","Auth","Persistence","LOCAL","signInAnonymously","logout","signOut","getVapidKey","onAuth","userData","commit","user","uid","userRef","firestore","collection","doc","sellRef","buyRef","noticeRef","get","then","exists","update","updated_at","FieldValue","serverTimestamp","set","created_at","name","count","items"],"mappings":"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","sourcesContent":["import Vue from 'vue'\nimport firebase from 'firebase';\nimport store from \"@/store\";\n\nconst config = {\n  apiKey: \"AIzaSyD8t5QJEMKbg5RYoPN48zk7Kjth6Hb0fxM\",\n  authDomain: \"choco-mart.firebaseapp.com\",\n  databaseURL: \"https://choco-mart.firebaseio.com\",\n  projectId: \"choco-mart\",\n  storageBucket: \"choco-mart.appspot.com\",\n  messagingSenderId: \"779047029524\",\n  appId: \"1:779047029524:web:c37d738044284f727b5001\",\n  measurementId: \"G-2PDBMYBW5Z\"\n}\n\nconst VAPID_KEY = 'BCDw3v7pzwp3ybMscHQoAMeZ0qEVPNxR6lBXt4_IeUOthODzfpXVsmhNwPgxKMUx9B0LfX6k5EE_HEaCVngFGW4'\n\nexport default {\n  init() {\n    firebase.initializeApp(config);\n    firebase.analytics();\n    firebase.auth().setPersistence(firebase.auth.Auth.Persistence.LOCAL);\n  },\n  signInAnonymously () {\n    return firebase.auth().signInAnonymously()\n  },\n  logout() {\n    firebase.auth().signOut();\n  },\n  getVapidKey() {\n    return VAPID_KEY\n  },\n  async onAuth() {\n    let userData = await this.signInAnonymously()\n    store.commit('auth/onAuthStateChanged', userData.user);\n    store.commit('auth/onUserStatusChanged', userData.user.uid ? true : false);\n\n    let userRef = firebase.firestore().collection(\"users\").doc(userData.user.uid)\n    let sellRef = firebase.firestore().collection(\"sells\").doc(userData.user.uid)\n    let buyRef = firebase.firestore().collection(\"buys\").doc(userData.user.uid)\n    let noticeRef = firebase.firestore().collection(\"notices\").doc(userData.user.uid)\n\n    await userRef.get().then(function(doc) {\n      if (doc.exists) {\n        userRef.update({\n          updated_at: firebase.firestore.FieldValue.serverTimestamp()\n        })\n      } else {\n        // 初期設定(ユーザー)\n        userRef.set({\n          updated_at: firebase.firestore.FieldValue.serverTimestamp(),\n          created_at: firebase.firestore.FieldValue.serverTimestamp(),\n          name: \"名も無き冒険者\"\n        })\n        // 初期設定(売る)\n        sellRef.set({\n          count: 15,\n        })\n        // 初期設定(売る)\n        buyRef.set({\n          count: 15,\n        })\n        // 初期設定(通知)\n        noticeRef.set({\n          items: []\n        })\n      }\n    });\n  }\n};"]}]}